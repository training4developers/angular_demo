{"version":3,"file":"animations-browser-testing.umd.js","sources":["../../../../packages/animations/browser/testing/src/mock_animation_driver.ts"],"sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nimport {AUTO_STYLE, AnimationPlayer, NoopAnimationPlayer, ɵStyleData} from '@angular/animations';\n\nimport {AnimationDriver} from '../../src/render/animation_driver';\n\n/**\n * @experimental Animation support is experimental.\n */\nexport class MockAnimationDriver implements AnimationDriver {\n  static log: AnimationPlayer[] = [];\n\n  animate(\n      element: any, keyframes: {[key: string]: string | number}[], duration: number, delay: number,\n      easing: string, previousPlayers: any[] = []): MockAnimationPlayer {\n    const player =\n        new MockAnimationPlayer(element, keyframes, duration, delay, easing, previousPlayers);\n    MockAnimationDriver.log.push(<AnimationPlayer>player);\n    return player;\n  }\n}\n\n/**\n * @experimental Animation support is experimental.\n */\nexport class MockAnimationPlayer extends NoopAnimationPlayer {\n  private __finished = false;\n  public previousStyles: {[key: string]: string | number} = {};\n\n  constructor(\n      public element: any, public keyframes: {[key: string]: string | number}[],\n      public duration: number, public delay: number, public easing: string,\n      public previousPlayers: any[]) {\n    super();\n    previousPlayers.forEach(player => {\n      if (player instanceof MockAnimationPlayer) {\n        const styles = player._captureStyles();\n        Object.keys(styles).forEach(prop => { this.previousStyles[prop] = styles[prop]; });\n      }\n    });\n  }\n\n  finish(): void {\n    super.finish();\n    this.__finished = true;\n  }\n\n  destroy(): void {\n    super.destroy();\n    this.__finished = true;\n  }\n\n  private _captureStyles(): {[styleName: string]: string | number} {\n    const captures: ɵStyleData = {};\n\n    Object.keys(this.previousStyles).forEach(prop => {\n      captures[prop] = this.previousStyles[prop];\n    });\n\n    if (this.hasStarted()) {\n      // when assembling the captured styles, it's important that\n      // we build the keyframe styles in the following order:\n      // {other styles within keyframes, ... previousStyles }\n      this.keyframes.forEach(kf => {\n        Object.keys(kf).forEach(prop => {\n          if (prop != 'offset') {\n            captures[prop] = this.__finished ? kf[prop] : AUTO_STYLE;\n          }\n        });\n      });\n    }\n\n    return captures;\n  }\n}\n"],"names":["NoopAnimationPlayer","AUTO_STYLE"],"mappings":"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"}